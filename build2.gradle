
ext {
  sanityCheckFramework = 'src/main/mk/test.mk'
}

task sanity {
  dependsOn 'testVariableSanity'
}

n





task testVariables {
  def test = new MakefileTest()

  test.testVariables()
}



task testVariableSanity {

  Makefile oldMakefile = new Makefile()
  Makefile newMakefile = new Makefile()

  doLast {
    [oldMakefile, newMakefile].collect {
      def output = new ByteArrayOutputStream()

      exec {
        executable 'make'

        args "-f ${oldMakefile}", "-f ${sanityCheckFramework}", 'printvars'
        standardOutput = output
      }

      it = output.toString()
    }
  }


}